---
import { readPages, type FieldsArray } from "@/core/controllers/pageController";

const params = Astro.url.searchParams;
const fields = (params.get("fields")?.split(",") ?? [
  "id",
  "slug",
  "parent_id",
]) as FieldsArray;

const pages = await readPages({
  fields,
});

console.log(typeof pages[0].created_at);
---

<table>
  <thead>
    <tr>
      {fields.map((f) => <th>{f}</th>)}
    </tr>
  </thead>
  <tbody>
    {
      pages.map((page) => (
        <tr>
          {fields.map((f) => (
            <td>{page[f] ?? "null"}</td>
          ))}
        </tr>
      ))
    }
  </tbody>
</table>
